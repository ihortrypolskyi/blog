<p id="notice"><%= notice %></p>

<div id="heading">
  <h1><%= t('posts_list') %></h1>
</div>

<table>
  <thead>
  <tr>
    <th></th>
    <th><%= t('title') %></th>
    <th><%= t('content') %></th>
    <th><%= t('user') %></th>
    <th colspan="3"></th>
  </tr>
  </thead>

  <tbody>
  <% @posts.each do |post| %>
      <tr>
        <td id="large_image"><%= image_tag post.image.url(:thumb) if post.image? %></td>
        <td id="table_title"><%= post.title %></td>
        <td id="table_body"><%= post.body %></td>
        <td id="table_user"><%= post.user.first_name %> <%= post.user.last_name %></td>
        <nav><td ><%= link_to t('show'), post_path(post) %><br>
          <% if post.user.id == current_user.id %>
              <%= link_to t('edit'), edit_post_path(post) %><br>
              <%= link_to t('delete'), post_path(post),
                          method: :delete, data: { confirm: t('Are you sure?') } %></td></nav>
          <% end %>
          <tr>
            <th></th>
            <td id="post_created"><%= t('post_created') %><%= l post.created_at, format: :long %></td>
          </tr>
          <tr>
            <th></th>
            <% if post.comments.count >= 1 %>
                <td class="comments-link" class="comments"> <%= link_to( image_tag('comments.jpg', size: '30')) %> <%= post.comments.count %></td>
            <% else %>
                <td class="no_comments" > <%= image_tag('comments.jpg', size: '30') %> <%= post.comments.count %></td>
            <% end %>
          </tr>

          <% post.comments.each do |comment| %>
              <tr class="comments-section">
                <td></td>
                <td id="post_title"><%= comment.user.first_name %> <%= comment.user.last_name %><br>
                  <%= time_ago_in_words(comment.created_at) %><%= t('ago') %></td>
                <!--<td id="post_title"><%= comment.created_at.strftime('%d-%m-%Y %H:%M') %></td>-->
                <td id="post_body"><%= comment.content %></td>
                <% if comment.user_id == current_user.id && comment == post.comments.last %>
                    <nav>
                      <td><%= link_to t('edit'), edit_post_comment_path(comment.post, comment) %><br>
                        <%= link_to t('delete'), [comment.post, comment],
                                    method: :delete, data: { confirm: t('Are you sure?') } %></td>
                    </nav>
                <% end %>
              </tr>

          <% end %>
          <td></td>
  <% end %>
  </tbody>
</table>
<br>
<nav><%= link_to t('new_post'), new_post_path %></nav>